"0",""
"0","nba<-read.csv(""C:/Users/Equipo/Desktop/CUNEF/Prediccion/Datos/nba.csv"")"
"0",""
"0","#Lo primero he cargado las librerias que iba a necesitar"
"0",""
"0","library(MASS)"
"0","library(leaps)"
"0","library(dplyr)"
"0","library(tidyverse)"
"0","library(fBasics)"
"0",""
"0","#La base de datos contiene un total de 485 registros agrupados en 28 variables."
"0","#Se va a tratar de dar explicacion a la relacion existente entre el salario de "
"0","#cada jugador con sus estadisticas individuales y ase obtener un modelo de prediccion "
"0","#tomando como variable dependiente el salario y como variables independientes dichas"
"0","#estadisticas. Sabemos que existen dos NAs"
"0",""
"0",""
"0","names(nba)"
"1"," [1]"
"1"," ""Player""         "
"1"," ""Salary""         "
"1"," ""NBA_Country""    "
"1"," ""NBA_DraftNumber"""
"1","
"
"1"," [5]"
"1"," ""Age""            "
"1"," ""Tm""             "
"1"," ""G""              "
"1"," ""MP""             "
"1","
"
"1"," [9]"
"1"," ""PER""            "
"1"," ""TS.""            "
"1"," ""X3PAr""          "
"1"," ""FTr""            "
"1","
"
"1","[13]"
"1"," ""ORB.""           "
"1"," ""DRB.""           "
"1"," ""TRB.""           "
"1"," ""AST.""           "
"1","
"
"1","[17]"
"1"," ""STL.""           "
"1"," ""BLK.""           "
"1"," ""TOV.""           "
"1"," ""USG.""           "
"1","
"
"1","[21]"
"1"," ""OWS""            "
"1"," ""DWS""            "
"1"," ""WS""             "
"1"," ""WS.48""          "
"1","
"
"1","[25]"
"1"," ""OBPM""           "
"1"," ""DBPM""           "
"1"," ""BPM""            "
"1"," ""VORP""           "
"1","
"
"0","nba<-na.omit(nba)"
"0",""
"0","#steep forward "
"0",""
"0","regfit.fwd=regsubsets(Salary~.-Player -NBA_Country -ORB. -DRB.-Tm, nba ,method =""forward"")"
"0",""
"0","resumen<-summary (regfit.fwd)"
"0",""
"0","modelo<-lm(formula = Salary ~ Age + NBA_DraftNumber + G + MP + USG.+ DBPM+ STL. + WS, data = nba)"
"0",""
"0","resumen$bic"
"1","[1]"
"1"," -195.4434"
"1"," -247.4542"
"1"," -277.9638"
"1"," -287.7754"
"1"," -290.6157"
"1"," -323.9518"
"1"," -321.1161"
"1"," -317.7580"
"1","
"
"0","summary(modelo)"
"1","
Call:
"
"1",""
"1","lm(formula = Salary ~ Age + NBA_DraftNumber + G + MP + USG. + 
    DBPM + STL. + WS, data = nba)"
"1",""
"1","

"
"1",""
"1","Residuals:
"
"1","      Min "
"1","       1Q "
"1","   Median "
"1","       3Q "
"1","      Max "
"1","
"
"1","-14435369 "
"1"," -2995507 "
"1","  -404761 "
"1","  2273171 "
"1"," 23099343 "
"1","
"
"1","
Coefficients:
"
"1","               "
"1","   Estimate"
"1"," Std. Error"
"1"," t value"
"1"," Pr(>|t|)"
"1","    "
"1","
(Intercept)    "
"1"," -6674087.0"
"1","  1983563.9"
"1","  -3.365"
"1"," 0.000828"
"1"," ***"
"1","
Age            "
"1","   521471.4"
"1","    54982.0"
"1","   9.484"
"1","  < 2e-16"
"1"," ***"
"1","
NBA_DraftNumber"
"1","   -64760.4"
"1","    12123.6"
"1","  -5.342"
"1"," 1.43e-07"
"1"," ***"
"1","
G              "
"1","  -160334.7"
"1","    21668.7"
"1","  -7.399"
"1"," 6.28e-13"
"1"," ***"
"1","
MP             "
"1","     5394.4"
"1","      799.6"
"1","   6.746"
"1"," 4.43e-11"
"1"," ***"
"1","
USG.           "
"1","   112966.7"
"1","    51273.1"
"1","   2.203"
"1"," 0.028058"
"1"," *  "
"1","
DBPM           "
"1","   347163.4"
"1","   143323.3"
"1","   2.422"
"1"," 0.015799"
"1"," *  "
"1","
STL.           "
"1","  -461165.2"
"1","   276718.8"
"1","  -1.667"
"1"," 0.096265"
"1"," .  "
"1","
WS             "
"1","   850413.1"
"1","   153783.9"
"1","   5.530"
"1"," 5.30e-08"
"1"," ***"
"1","
"
"1","---
Signif. codes:  "
"1",""
"1","0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1"
"1","
"
"1","
Residual standard error:"
"1"," "
"1","5069000"
"1"," "
"1","on"
"1"," "
"1","474"
"1"," "
"1","degrees of freedom"
"1","
"
"1","Multiple R-squared: "
"1"," "
"1","0.5384"
"1",",	Adjusted R-squared: "
"1"," "
"1","0.5306"
"1"," "
"1","
F-statistic:"
"1"," "
"1","69.11"
"1"," "
"1","on"
"1"," "
"1","8"
"1"," "
"1","and"
"1"," "
"1","474"
"1"," "
"1","DF,  p-value:"
"1"," "
"1","< 2.2e-16"
"1","
"
"1","
"
"0","#Me voy a quedar con los 3 modelos que menor BIC tienen en este caso el 6, 7 y 8."
"0","#Este modelo lineal solo contiene las variables comunes a los 3 modelos que seleccione"
"0",""
"0","modelo2<-lm(formula = Salary ~ Age + NBA_DraftNumber + G + MP + WS, data = nba)"
"0",""
"0","resumen$bic"
"1","[1]"
"1"," -195.4434"
"1"," -247.4542"
"1"," -277.9638"
"1"," -287.7754"
"1"," -290.6157"
"1"," -323.9518"
"1"," -321.1161"
"1"," -317.7580"
"1","
"
"0","summary(modelo2)"
"1","
Call:
"
"1",""
"1","lm(formula = Salary ~ Age + NBA_DraftNumber + G + MP + WS, data = nba)"
"1",""
"1","

"
"1",""
"1","Residuals:
"
"1","      Min "
"1","       1Q "
"1","   Median "
"1","       3Q "
"1","      Max "
"1","
"
"1","-15153093 "
"1"," -2948000 "
"1","  -351184 "
"1","  2198215 "
"1"," 22091767 "
"1","
"
"1","
Coefficients:
"
"1","               "
"1","   Estimate"
"1"," Std. Error"
"1"," t value"
"1"," Pr(>|t|)"
"1","    "
"1","
(Intercept)    "
"1"," -5241479.3"
"1","  1562124.2"
"1","  -3.355"
"1"," 0.000856"
"1"," ***"
"1","
Age            "
"1","   505712.1"
"1","    54713.9"
"1","   9.243"
"1","  < 2e-16"
"1"," ***"
"1","
NBA_DraftNumber"
"1","   -71763.3"
"1","    11876.7"
"1","  -6.042"
"1"," 3.06e-09"
"1"," ***"
"1","
G              "
"1","  -157365.4"
"1","    19540.5"
"1","  -8.053"
"1"," 6.49e-15"
"1"," ***"
"1","
MP             "
"1","     5323.9"
"1","      750.5"
"1","   7.094"
"1"," 4.73e-12"
"1"," ***"
"1","
WS             "
"1","  1006514.7"
"1","   142176.5"
"1","   7.079"
"1"," 5.21e-12"
"1"," ***"
"1","
"
"1","---
Signif. codes:  "
"1",""
"1","0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1"
"1","
"
"1","
Residual standard error:"
"1"," "
"1","5093000"
"1"," "
"1","on"
"1"," "
"1","477"
"1"," "
"1","degrees of freedom"
"1","
"
"1","Multiple R-squared: "
"1"," "
"1","0.531"
"1",",	Adjusted R-squared: "
"1"," "
"1","0.526"
"1"," "
"1","
F-statistic:"
"1"," "
"1","  108"
"1"," "
"1","on"
"1"," "
"1","5"
"1"," "
"1","and"
"1"," "
"1","477"
"1"," "
"1","DF,  p-value:"
"1"," "
"1","< 2.2e-16"
"1","
"
"1","
"
"0","residuos<-resid(modelo2)"
"0",""
"0","shapiro.test(residuos)"
"1","
"
"1","	Shapiro-Wilk normality test"
"1","
"
"1","
"
"1","data:  "
"1",""
"1","residuos"
"1",""
"1","
"
"1","W = 0.97154, p-value = 0.00000004472"
"1","
"
"1","
"
"0","#La muestra no esta distribuida de manera normal segun el test de Shapiro Wilk"
"0",""
"0","regfit.fwd2=regsubsets(Salary~.-Player -NBA_Country -ORB. -DRB.-Tm -PER -TS. -X3PAr -FTr -AST. -STL. -BLK. -TOV. -USG. -OWS -DWS -WS.48 -OBPM -DBPM -BPM -VORP, nba ,method =""forward"")"
"0",""
"0","summary(regfit.fwd2)"
"1","Subset selection object
"
"1","Call: "
"1","regsubsets.formula(Salary ~ . - Player - NBA_Country - ORB. - 
"
"1","    DRB. - Tm - PER - TS. - X3PAr - FTr - AST. - STL. - BLK. - 
"
"1","    TOV. - USG. - OWS - DWS - WS.48 - OBPM - DBPM - BPM - VORP, 
"
"1","    nba, method = ""forward"")
"
"1","6"
"1"," Variables "
"1"," (and intercept)"
"1","
"
"1","               "
"1"," Forced in"
"1"," Forced out"
"1","
NBA_DraftNumber"
"1","     FALSE"
"1","      FALSE"
"1","
Age            "
"1","     FALSE"
"1","      FALSE"
"1","
G              "
"1","     FALSE"
"1","      FALSE"
"1","
MP             "
"1","     FALSE"
"1","      FALSE"
"1","
TRB.           "
"1","     FALSE"
"1","      FALSE"
"1","
WS             "
"1","     FALSE"
"1","      FALSE"
"1","
"
"1","1"
"1"," subsets of each size up to "
"1","6"
"1","
"
"1","Selection Algorithm: "
"1","forward"
"1","
"
"1","        "
"1"," NBA_DraftNumber"
"1"," Age"
"1"," G  "
"1"," MP "
"1"," TRB."
"1"," WS "
"1","
1  ( 1 )"
"1"," "" ""            "
"1"," "" """
"1"," "" """
"1"," "" """
"1"," "" "" "
"1"," ""*"""
"1","
2  ( 1 )"
"1"," "" ""            "
"1"," ""*"""
"1"," "" """
"1"," "" """
"1"," "" "" "
"1"," ""*"""
"1","
3  ( 1 )"
"1"," ""*""            "
"1"," ""*"""
"1"," "" """
"1"," "" """
"1"," "" "" "
"1"," ""*"""
"1","
4  ( 1 )"
"1"," ""*""            "
"1"," ""*"""
"1"," ""*"""
"1"," "" """
"1"," "" "" "
"1"," ""*"""
"1","
5  ( 1 )"
"1"," ""*""            "
"1"," ""*"""
"1"," ""*"""
"1"," ""*"""
"1"," "" "" "
"1"," ""*"""
"1","
6  ( 1 )"
"1"," ""*""            "
"1"," ""*"""
"1"," ""*"""
"1"," ""*"""
"1"," ""*"" "
"1"," ""*"""
"1","
"
